var BaseService=function(){return"object"==typeof BaseService.instance?BaseService.instance:(debug("build BaseService instance"),void(BaseService.instance=this))};BaseService.prototype={ajax:function(t){var e=Est.extend({_method:"GET"},t);return $.ajax({type:"post",url:t.url,async:!1,cache:t.cache,data:e,success:function(t){}})},initTree:function(t,e){t.tree&&(e.attributes.data=Est.bulidTreeNode(e.attributes.data,t.rootKey,t.rootValue,{categoryId:t.categoryId,belongId:t.belongId,childTag:t.childTag,sortBy:t.sortBy,callback:function(e){t.tree&&(e.text=e[t.text],e.value=e[t.value])}}))},initSelect:function(t,e){t.select&&(Est.each(e.attributes.data,function(e){e.text=e[t.text],e.value=e[t.value]}),t.tree&&(e.attributes.data=Est.bulidSelectNode(e.attributes.data,1,{name:"text"})))},initExtend:function(t,e){t.extend&&(e.attributes.data=Est.extendTree(e.attributes.data))},initDefault:function(t,e){e.attributes&&t.defaults&&"array"===Est.typeOf(e.attributes.data)&&e.attributes.data.unshift({text:CONST.LANG.SELECT_DEFAULT,value:t.defaultValue})},factory:function(t){var e=this,a=Est.promise,i="",s="",n=null;t=Est.extend({select:!1,extend:!1,defaults:!1,tree:!1,defaultValue:null,cache:!1},t);for(var r in t)i+=t[r];return s="_hash"+Est.hash(i),new a(t.session&&!app.getData("versionUpdated")&&(n=app.getSession(s))?function(t,e){t(JSON.parse(n))}:function(a,i){CONST.DEBUG_LOCALSERVICE?a([]):e.ajax(t).done(function(i){var n=null;return"string"===Est.typeOf(i)?(t.session&&i.attributes&&app.addSession(s,i),void a(i)):(i.attributes?(e.initTree(t,i),e.initSelect(t,i),e.initExtend(t,i)):(i.attributes=i.attributes||{},i.attributes.data=[]),e.initDefault(t,i),n=i.attributes?i.attributes.data:i,t.session&&i.attributes&&app.addSession(s,JSON.stringify(n)),void a(n))})})},query:function(t){var e=this,a=Est.promise,i="",s="",n=null;t=Est.extend({cache:!1},t);for(var r in t)i+=t[r];return s="_hash"+Est.hash(i),new a(t.session&&!app.getData("versionUpdated")&&(n=app.getSession(s))?function(t,e){t(JSON.parse(n))}:function(a,i){CONST.DEBUG_LOCALSERVICE?a([]):e.ajax(t).done(function(e){e.msg===CONST.LANG.NOT_LOGIN&&Est.trigger("checkLogin"),t.session&&e&&app.addSession(s,JSON.stringify(e)),a(e)})})}};