var BaseDetail=SuperView.extend({_initialize:function(t){this._initOptions(t),this._initTemplate(this._options),this._initList(this._options),this._initModel(t.model,this),this._initEnterEvent(this._options)},_initOptions:function(t){this._options=Est.extend(this.options,t||{}),this._options.speed=this._options.speed||9},_initTemplate:function(t){return this._data=t.data=t.data||{},t.template&&(this.template=Handlebars.compile(t.template),this.$template="<div>"+t.template+"</div>"),this._data},_initList:function(t){var e=this;return this.list=t.render?this.$(t.render):this.$el,0===this.list.size()&&(this.list=$(t.render)),debug(function(){return e.list&&0!==e.list.size()?void 0:"Error15 viewId="+e.options.viewId+(e._options.render?e._options.render:e.el)},{type:"error"}),this.list},_render:function(){this._initDefault&&this._initDefault.call(this),this.beforeRender&&this.beforeRender.call(this,this._options),this.list.append(this.template(this.model.attributes)),this._options.modelBind&&this._modelBind(),window.topDialog&&this.$(".form-actions").hide(),this._watchBind&&this._watchBind.call(this,this._options.template),this._bbBind&&this._bbBind.call(this,this._options.template,this.$el),this.afterRender&&this.afterRender.call(this,this._options),this._options.form&&this._form(this._options.form)._initSubmit({beforeSave:this.beforeSave,afterSave:this.afterSave}),this._options.toolTip&&this._initToolTip(),BaseUtils.removeLoading()},_initModel:function(t,e){debug(function(){return t?void 0:"Error16"},{type:"error"}),e.passId=this.options.id||this._options.data.id||Est.getUrlParam("id",window.location.href),Est.isEmpty(this.passId)?(e.passId=(new Date).getTime(),e.model=new t(this._options.data||{}),e.model.set("_data",e._options.data),e.model.set("_isAdd",e._isAdd=!0),e.render()):(e.model=new t,e.model.set("id",e.passId),e.model.set("_data",e._options.data),e.model.set("CONST",CONST),e.model.fetch().done(function(t){t.msg===CONST.LANG.NOT_LOGIN&&Est.trigger("checkLogin"),e.model.set("_isAdd",e._isAdd=!1),e.render()})),this._options.hideOkBtn&&(e.model.hideOkBtn=!0),this._options.hideSaveBtn&&(e.model.hideSaveBtn=!0),this._options.autoHide&&(e.model.autoHide=!0)},_form:function(t){return this.formSelector=t,this.formElemnet=this.$(this.formSelector),this},_validate:function(t){return this},_initSubmit:function(t){var e=this,i=!0,s=!0;t=t||{},$("#submit",this.el).on("click",function(){var o=$(this),n=o.is("input"),r=e.preText=n?o.val():o.html();if(i=!0,e.formElemnet.submit(),$("input, textarea, select",$(e.formSelector)).each(function(){var t,s,o,n,r;t=$(this).attr("name"),$(this).hasClass("bui-form-field-error")&&(i=!1);var a=$(this).attr("id");if(a&&-1!==a.indexOf("model")){switch(this.type){case"radio":s=$(this).is(":checked")?$(this).val():o=!0;break;case"checkbox":s=$(this).is(":checked")?Est.isEmpty($(this).attr("true-value"))?!0:$(this).attr("true-value"):Est.isEmpty($(this).attr("false-value"))?!1:$(this).attr("false-value");break;default:s=$(this).val()}if(!o)if(n=a.replace(/^model\d?-(.+)$/g,"$1"),r=n.split("."),r.length>1)try{e.model.attributes[r[0]]||(e.model.attributes[r[0]]={}),Est.setValue(e.model.attributes,n,s)}catch(l){debug("Error18 "+l)}else e.model.set(r[0],s)}}),i){if("undefined"!=typeof t.beforeSave&&(s=t.beforeSave.call(e)),"undefined"!==Est.typeOf(s)&&!s)return!1;n?o.val(CONST.LANG.SUBMIT):o.html(CONST.LANG.SUBMIT),o.prop("disabled",!0),e._save(function(i){t.afterSave&&(t.afterSave=Est.inject(t.afterSave,function(t){return new Est.setArguments(arguments)},function(t){n?o.val(r):o.html(r),o.prop("disabled",!1)}),t.afterSave.call(e,i,"string"===Est.typeOf(i)?!0:"boolean"===Est.typeOf(Est.getValue(i,"attributes._response.success"))?Est.getValue(i,"attributes._response.success"):!0)),o.html(r)},function(i){i.msg===CONST.LANG.NOT_LOGIN&&Est.trigger("checkLogin"),t.onErrorSave&&t.onErrorSave.call(e,i)}),setTimeout(function(){o.html(r),o.prop("disabled",!1)},5e3)}return!1})},_save:function(t,e){this._saveItem(t,e)},_saveItem:function(t,e){return debug("- BaseDetail._saveItem"),"string"===Est.typeOf(this.model.url)&&debug("Error29",{type:"error"}),Est.isEmpty(this.model.url())?void debug("Error19",{type:"error"}):(this.model.attributes._response&&delete this.model.attributes._response,void this.model.save(null,{wait:!0,success:function(e){debug("- BaseDetail._saveSuccess"),app.addModel(Est.cloneDeep(e.attributes)),top&&(top.model=e.attributes),t&&"function"==typeof t&&t.call(this,e)},error:function(i,s,o){200===s.status?t.call(this,s.responseText):e&&"function"==typeof e&&e.call(this,s,i,o)}}))},_empty:function(){this.model.off(),this.$el.empty().off()},_close:function(){debug("- BaseDetail.close"),this.undelegateEvents(),this.stopListening(),this.off()}});